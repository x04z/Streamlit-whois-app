import streamlit as st
import pandas as pd
import requests
import time
from concurrent.futures import ThreadPoolExecutor, wait, FIRST_COMPLETED
import socket
import struct
import random

# --- è¨­å®šï¼šAPIé€šä¿¡ã¨ä¸¦è¡Œå‡¦ç† ---
# ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«ã‚ˆã‚‹N/Aã‚’é˜²ããŸã‚ã€æ­£ç¢ºæ€§é‡è¦–ã§è¨­å®šã‚’èª¿æ•´
MAX_WORKERS = 5 
DELAY_BETWEEN_REQUESTS = 1.5 
# IP-APIã§ISPæƒ…å ±ã¨å›½æƒ…å ±ã‚’å–å¾—
IP_API_URL = "http://ip-api.com/json/{ip}?fields=status,country,isp,query"

# --- RIR/Registryã®URLå®šç¾© ---
# JPNIC/APNIC/LACNIC/AFRINICã¯ç›´æ¥ã‚¯ã‚¨ãƒªã‚’æŠ•ã’ã‚‹å½¢å¼ã¯é¿ã‘ã¦ã€å…¬å¼ã®Web Whoisæ¤œç´¢ãƒšãƒ¼ã‚¸ã«èª˜å°
RIR_LINKS = {
    'APNIC': 'https://wq.apnic.net/static/search.html',            # Asia Pacific (é™çš„æ¤œç´¢ãƒšãƒ¼ã‚¸ã«èª˜å°)
    'JPNIC': 'https://www.nic.ad.jp/ja/whois/ja-gateway.html',     # Japan (å…¬å¼Web Whoisã®ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«èª˜å°)
    'RIPE': 'https://apps.db.ripe.net/db-web-ui/#/query?searchtext={ip}', # Europe, Middle East (ã‚¯ã‚¨ãƒªåŸ‹ã‚è¾¼ã¿å¯)
    'ARIN': 'https://search.arin.net/rdap/?query?query={ip}',            # North America (ã‚¯ã‚¨ãƒªåŸ‹ã‚è¾¼ã¿å¯)
    'LACNIC': 'https://rdap-web.lacnic.net',                       # Latin America (Web Whoisæ¤œç´¢ãƒšãƒ¼ã‚¸ã«èª˜å°)
    'AFRINIC': 'https://afrinic.net/whois',                        # Africa (Web Whoisæ¤œç´¢ãƒšãƒ¼ã‚¸ã«èª˜å°)
}

# --- å›½åã‹ã‚‰RIRã‚’åˆ¤å®šã™ã‚‹ãƒãƒƒãƒ”ãƒ³ã‚° (IP-APIã¯å›½åã‚’è¿”ã™ãŸã‚) ---
COUNTRY_TO_RIR = {
    'Japan': 'JPNIC', 
    'United States': 'ARIN', 'Canada': 'ARIN', 'Mexico': 'LACNIC',
    'Germany': 'RIPE', 'France': 'RIPE', 'United Kingdom': 'RIPE', 'Russia': 'RIPE', 
    'China': 'APNIC', 'Australia': 'APNIC', 'South Korea': 'APNIC', 'India': 'APNIC',
    'Brazil': 'LACNIC', 'Argentina': 'LACNIC',
    'Egypt': 'AFRINIC', 'South Africa': 'AFRINIC', 
}

# --- IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’32bitæ•´æ•°ã«å¤‰æ›ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•° ---
def ip_to_int(ip):
    """IPã‚¢ãƒ‰ãƒ¬ã‚¹æ–‡å­—åˆ—ã‚’æ•´æ•°ã«å¤‰æ›"""
    try:
        return struct.unpack("!I", socket.inet_aton(ip))[0]
    except OSError:
        # ç„¡åŠ¹ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ç„¡è¦–ã¾ãŸã¯ã‚¨ãƒ©ãƒ¼å‡¦ç†
        return 0

# --- æ¨©å¨ã‚ã‚‹RIRãƒªãƒ³ã‚¯ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•° ---
def get_authoritative_rir_link(ip, country):
    """å›½åã«åŸºã¥ãã€å”¯ä¸€ã®æ­£å¼ãªRIRãƒªãƒ³ã‚¯ã‚’ç‰¹å®šã—ç”Ÿæˆã™ã‚‹"""
    
    rir_name = COUNTRY_TO_RIR.get(country)
    
    # JPNICã€APNICã€LACNICã€AFRINICã®å ´åˆã¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’URLã«å«ã‚ãšã€
    # Whoisã®æ¤œç´¢ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«èª˜å°ã™ã‚‹
    if rir_name in ['JPNIC', 'APNIC', 'LACNIC', 'AFRINIC']:
        return f"[{rir_name}]({RIR_LINKS[rir_name]})"
    
    if rir_name:
        link_url = RIR_LINKS.get(rir_name)
        if link_url:
            return f"[{rir_name}]({link_url.format(ip=ip)})"
    
    # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç† (IP-APIãŒè¿”ã™å›½æƒ…å ±ã«åŸºã¥ãRIRã‚’æ¨å®š)
    if country in ['China', 'Australia', 'South Korea', 'Indonesia', 'Singapore', 'India']:
        rir_name = 'APNIC'
    elif country in ['Germany', 'France', 'United Kingdom', 'Italy', 'Spain']:
        rir_name = 'RIPE'
    elif country in ['Brazil', 'Argentina', 'Chile', 'Colombia']:
        rir_name = 'LACNIC'
    elif country in ['Egypt', 'Nigeria', 'Kenya', 'South Africa']:
        rir_name = 'AFRINIC'
    else:
        rir_name = 'APNIC (Fallback)'

    # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯RIRåã‹ã‚‰ãƒ™ãƒ¼ã‚¹åã‚’å–å¾—
    base_rir_name = rir_name.split(' ')[0]
    link_url = RIR_LINKS.get(base_rir_name, RIR_LINKS['APNIC'])
    
    # JPNICã€APNICã€LACNICã€AFRINICãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®å ´åˆã‚‚IPã‚’æ¸¡ã•ãªã„
    if base_rir_name in ['JPNIC', 'APNIC', 'LACNIC', 'AFRINIC']:
        # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å (ä¾‹: 'APNIC (Fallback)') ã¨é™çš„URLã‚’ä½¿ç”¨
        return f"[{rir_name}]({RIR_LINKS[base_rir_name]})"
        
    return f"[{rir_name}]({link_url.format(ip=ip)})"


# --- äºŒæ¬¡èª¿æŸ»ã‚µã‚¤ãƒˆã®ãƒªãƒ³ã‚¯ç”Ÿæˆé–¢æ•° ---
def create_secondary_links(ip):
    """ä¿¡é ¼æ€§ã®é«˜ã„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»Whoisèª¿æŸ»ã‚µã‚¤ãƒˆã¸ã®ãƒªãƒ³ã‚¯ã‚’ç”Ÿæˆã™ã‚‹"""
    
    links = {
        'VirusTotal': f'https://www.virustotal.com/gui/ip-address/{ip}',
        'Aguse': f'https://www.aguse.jp/?url={ip}',
        'Whois.com': f'https://www.whois.com/whois/{ip}',
        'DomainSearch.jp': f'https://www.domainsearch.jp/whois/?q={ip}', 
        'Who.is IP': f'https://who.is/whois-ip/ip-address/{ip}',      
    }
    
    link_html = ""
    for name, url in links.items():
        link_html += f"[{name}]({url}) | "
        
    return link_html.rstrip(' | ').replace(' | ', ' |\n')

# --- IPæƒ…å ±ã‚’APIã§å–å¾—ã™ã‚‹é–¢æ•° ---
def get_ip_details_from_api(ip):
    """IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®è©³ç´°æƒ…å ±ã‚’APIçµŒç”±ã§å–å¾—ã—ã€RIRãƒªãƒ³ã‚¯ã‚’åˆ¤å®šã™ã‚‹"""
    
    result = {
        'Target_IP': ip,
        'ISP': 'N/A',
        'Country': 'N/A',
        'Authoritative_RIR_Link': 'N/A',
        'Secondary_Security_Links': 'N/A',
        'Status': 'N/A'
    }

    try:
        # APIã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’è€ƒæ…®ã—ãŸé…å»¶
        time.sleep(DELAY_BETWEEN_REQUESTS) 
        
        url = IP_API_URL.format(ip=ip)
        response = requests.get(url, timeout=5)
        response.raise_for_status()
        data = response.json()
        
        if data.get('status') == 'success':
            country = data.get('country', 'N/A')
            result['ISP'] = data.get('isp', 'N/A')
            result['Country'] = country
            result['Status'] = 'Success (API)'
            
            result['Authoritative_RIR_Link'] = get_authoritative_rir_link(ip, country)
        else:
            result['Status'] = f"API Error: {data.get('message', 'Unknown')}"

    except requests.exceptions.RequestException as e:
        result['Status'] = f'Network Error: {e}'
    
    result['Secondary_Security_Links'] = create_secondary_links(ip)
    
    return result

# --- çµæœã‚’é›†ç´„ã™ã‚‹é–¢æ•° (ISPã¨Countryã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–) ---
def group_results_by_isp(results):
    """ISPã¨CountryãŒåŒã˜IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã€ç¯„å›²è¡¨ç¤ºã«å¤‰æ›ã™ã‚‹"""
    grouped = {}
    
    # 1. ISPã¨Countryã®çµ„ã¿åˆã‚ã›ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
    for res in results:
        # N/Aãƒ‡ãƒ¼ã‚¿ã¯é™¤å¤–
        if res['ISP'] == 'N/A' or res['Country'] == 'N/A':
            continue
            
        # ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã®ã‚­ãƒ¼ (ISP, Country)
        key = (res['ISP'], res['Country'])
        if key not in grouped:
            grouped[key] = {
                'IP_Ints': [],
                'IPs_List': [], # æ¤œç´¢ã•ã‚ŒãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒªã‚¹ãƒˆ
                'RIR_Link': res['Authoritative_RIR_Link'],
                'Secondary_Links': res['Secondary_Security_Links'],
                'ISP': res['ISP'],
                'Country': res['Country'],
                'Status': res['Status']
            }
        
        # IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ•´æ•°ã«å¤‰æ›ã—ã¦æ ¼ç´ (ã‚½ãƒ¼ãƒˆã®ãŸã‚)
        ip_int = ip_to_int(res['Target_IP'])
        if ip_int != 0:
            grouped[key]['IP_Ints'].append(ip_int)
            grouped[key]['IPs_List'].append(res['Target_IP'])
        
    # 2. ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«ç¯„å›²ã‚’æ±ºå®šã—ã€æ•´å½¢
    final_grouped_results = []
    for key, data in grouped.items():
        if not data['IP_Ints']:
            continue

        # æ•´æ•°å€¤ã§ã‚½ãƒ¼ãƒˆã—ã€æœ€å°å€¤ã¨æœ€å¤§å€¤ã‚’å–å¾—
        sorted_ip_ints = sorted(data['IP_Ints'])
        min_int = sorted_ip_ints[0]
        max_int = sorted_ip_ints[-1]
        
        # ç¯„å›²è¡¨ç¤ºã®ç”Ÿæˆ
        try:
            min_ip = socket.inet_ntoa(struct.pack('!I', min_int))
            max_ip = socket.inet_ntoa(struct.pack('!I', max_int))
        except ValueError:
            # å¤‰æ›ã‚¨ãƒ©ãƒ¼æ™‚ã¯å…ƒã®IPãƒªã‚¹ãƒˆã‹ã‚‰ä»£è¡¨IPã‚’ä½¿ç”¨
            min_ip = data['IPs_List'][0]
            max_ip = data['IPs_List'][-1]


        count = len(data['IPs_List'])
        
        if count == 1:
              # IPãŒ1ã¤ã—ã‹ãªã„å ´åˆã¯ã€ãã®ã¾ã¾è¡¨ç¤º
              target_ip_display = min_ip
        else:
              # IPãŒè¤‡æ•°ã‚ã‚‹å ´åˆã¯ç¯„å›²ã¨ä»¶æ•°ã‚’è¡¨ç¤º
              target_ip_display = f"{min_ip} - {max_ip} (x{count} IPs)"
        
        final_grouped_results.append({
            'Target_IP': target_ip_display,
            'Country': data['Country'],
            'ISP': data['ISP'],
            # RIR/Secondaryãƒªãƒ³ã‚¯ã¯ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®æœ€åˆã®IPã§å–å¾—ã—ãŸã‚‚ã®ã‚’ä½¿ç”¨
            'Authoritative_RIR_Link': data['RIR_Link'],
            'Secondary_Security_Links': data['Secondary_Links'],
            'Status': f"Aggregated ({count} IPs)" if count > 1 else data['Status']
        })
        
    return final_grouped_results


# --- çµæœã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•° ---
def display_results(results_to_display):
    """çµæœã‚’Markdownãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹"""
    header = "| Target IP | Country | ISP | **ç®¡è½„RIRãƒªãƒ³ã‚¯** | Secondary Links | Status |"
    separator = "| :--- | :--- | :--- | :--- | :--- | :--- |"
    st.markdown(header, unsafe_allow_html=True)
    st.markdown(separator, unsafe_allow_html=True)

    for row in results_to_display:
        # Markdownã®ã‚»ãƒ«å†…ã§æ”¹è¡ŒãŒèµ·ã“ã‚‰ãªã„ã‚ˆã†ã«ã‚¹ãƒšãƒ¼ã‚¹ã«ç½®æ›
        rir_link = row['Authoritative_RIR_Link'].replace('\n', ' ')
        secondary_links = row['Secondary_Security_Links'].replace('\n', ' ')
        
        line = (
            f"| {row['Target_IP']} "
            f"| {row['Country']} "
            f"| {row['ISP']} "
            f"| {rir_link} "
            f"| {secondary_links} "
            f"| {row['Status']} |"
        )
        st.markdown(line, unsafe_allow_html=True)

# --- å¾…ã¡æ™‚é–“è¡¨ç¤ºã®ãŸã‚ã®éƒ½é“åºœçœŒã€Œè©±ã®ãƒã‚¿ã€ãƒ‡ãƒ¼ã‚¿ ---
PREFECTURE_TIPS = {
    'åŒ—æµ·é“': [
        "1. åŒ—æµ·é“ã®ã‚³ãƒ³ãƒ“ãƒ‹ã€Œã‚»ã‚¤ã‚³ãƒ¼ãƒãƒ¼ãƒˆã€ã¯ã€åº—å†…ã§èª¿ç†ã™ã‚‹ã€Œãƒ›ãƒƒãƒˆã‚·ã‚§ãƒ•ã€ã®ãƒ•ãƒ©ã‚¤ãƒ‰ãƒã‚­ãƒ³ãŒç¥ã€‚åœ°å…ƒã®ã‚½ã‚¦ãƒ«ãƒ•ãƒ¼ãƒ‰ã§ã™ã€‚",
        "2. å†¬ã®é‹å‹•ä¼šã§ã¯ã€é›ªã®ä¸Šã§ç¶±å¼•ãã‚„éšœå®³ç‰©ç«¶èµ°ã‚’ã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚å¤ã ã‘ã˜ã‚ƒãªã„ï¼",
        "3. ã€ŒåŒ—æµ·é“ã§é­é›£ã—ãŸã‚‰ã€ã¨ã‚Šã‚ãˆãšã‚³ãƒ³ãƒ“ãƒ‹ï¼ˆã‚»ã‚¤ã‚³ãƒ¼ãƒãƒ¼ãƒˆï¼‰ã‚’ç›®æŒ‡ã›ã€ã¨è¨€ã‚ã‚Œã‚‹ã»ã©ã€ã©ã“ã«ã§ã‚‚ã‚ã‚‹ï¼ˆæ°—ãŒã™ã‚‹ï¼‰ã€‚"
    ],
    'é’æ£®çœŒ': [
        "1. é’æ£®çœŒã«ã¯ã€Œãƒªãƒ³ã‚´é¢¨å‘‚ã€ã¨ã„ã†ã€æ¹¯èˆ¹ã«ãƒªãƒ³ã‚´ã‚’æµ®ã‹ã¹ã‚‹ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ¸©æ³‰ãŒã‚ã‚‹ã€‚",
        "2. å¤ã®ã€Œã­ã¶ãŸç¥­ã‚Šã€ã§ã¯ã€å±±è»Šã‚’å¼•ãäººãŸã¡ãŒã€Œãƒ©ãƒƒã‚»ãƒ©ãƒ¼ã€ã¨å«ã³ãªãŒã‚‰ä¹±èˆã™ã‚‹ç†±ç‹‚ã¶ã‚Šã€‚",
        "3. å…¨å›½ã§æœ€ã‚‚å¯’ã„æ™‚æœŸã€çœŒæ°‘ã¯ã€Œé›ªã‹ãã€ã‚’ã‚¹ãƒãƒ¼ãƒ„ã¨æ‰ãˆå§‹ã‚ã¾ã™ã€‚ã‚·ãƒ¼ã‚ºãƒ³ã‚ªãƒ•ã¯ç‰©è¶³ã‚Šãªã„ã‚‰ã—ã„ã€‚"
    ],
    'å²©æ‰‹çœŒ': [
        "1. å²©æ‰‹çœŒã«ã¯ã€ãŠé¤…ã‚’å¹´é–“ã‚’é€šã—ã¦æ—¥å¸¸çš„ã«é£Ÿã¹ã‚‹æ–‡åŒ–ãŒã‚ã‚Šã€é£Ÿã¹æ–¹ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ãŒ300ç¨®é¡ä»¥ä¸Šã‚ã‚‹ã¨ã‚‚è¨€ã‚ã‚Œã‚‹ã€‚",
        "2. ã€Œã‚ã‚“ã“ãã°ã€ã¯ã€ç«¶æŠ€ã§ã¯ãªãã€ŒãŠã‚‚ã¦ãªã—ã€ã®å¿ƒã€‚çµ¦ä»•ã•ã‚“ãŒãŠæ¤€ã‚’é‡ã­ã‚‹éŸ³ã¯é”æˆæ„Ÿï¼",
        "3. ã€Œã‚«ãƒƒãƒ‘æ•ç²è¨±å¯è¨¼ã€ãŒç™ºè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚ãŸã ã—ã€æ•ã¾ãˆãŸã¨ã—ã¦ã‚‚æœ‰åŠ¹æ´»ç”¨æ³•ã¯è¬ã§ã™ã€‚"
    ],
    'å®®åŸçœŒ': [
        "1. ä»™å°ã«ã¯ã€Œç‰›ã‚¿ãƒ³ã€æ–™ç†ãŒæœ‰åã ãŒã€ç‰¹ã«ç‚­ç«ã§ç„¼ã„ãŸé¦™ã°ã—ã•ãŒãŸã¾ã‚‰ãªã„ã€‚",
        "2. æ—¥æœ¬ä¸‰æ™¯ã®ä¸€ã¤ã€Œæ¾å³¶ã€ã¯ã€260ä½™ã‚Šã®å³¶ã€…ãŒæµ®ã‹ã¶çµ¶æ™¯ã€‚",
        "3. ä»™å°å¸‚æ°‘ã¯ã€ç‰›ã‚¿ãƒ³ã‚’é£Ÿã¹ã‚‹ã¨ä½“ãŒå…ƒæ°—ã«ãªã‚‹ã¨ä¿¡ã˜ã¦ã„ã‚‹ã€‚ã”è¤’ç¾ã§ã‚ã‚Šã€ä¸€ç¨®ã®å„€å¼ã§ã™ã€‚"
    ],
    'ç§‹ç”°çœŒ': [
        "1. ç§‹ç”°çœŒã«ã¯ã€Œãªã¾ã¯ã’ã€ã¨ã„ã†ã€æ€ ã‘å¿ƒã‚’æˆ’ã‚ã‚‹ç¥ã®ä½¿ã„ãŒã„ã‚‹ã€‚å­ä¾›ãŸã¡ã¯æ€–ãŒã‚‹ãŒã€å¤§äººã¯æ„Ÿå‹•ã€‚",
        "2. ã€Œãã‚ŠãŸã‚“ã½ã€ã¨ã„ã†ç±³ã‚’æ£’çŠ¶ã«ã—ãŸé£Ÿã¹ç‰©ãŒã‚ã‚Šã€é‹æ–™ç†ã®å…·æã¨ã—ã¦æ¬ ã‹ã›ãªã„ã€‚",
        "3. ã€Œç§‹ç”°ç¾äººã€ã¨ã¯ã„ã†ã‚‚ã®ã®ã€å†¬ã¯é›ªã«åŸ‹ã‚‚ã‚Œã¦ãªã‹ãªã‹å‡ºä¼šãˆãªã„ã¨ã„ã†çš®è‚‰ã‚ã„ãŸã‚¸ãƒ§ãƒ¼ã‚¯ãŒã‚ã‚‹ã€‚"
    ],
    'å±±å½¢çœŒ': [
        "1. å±±å½¢çœŒã«ã¯ã€æ—¥æœ¬ã§å”¯ä¸€ã€ã‚¯ãƒ©ã‚²ã®å±•ç¤ºã«ç‰¹åŒ–ã—ãŸã€ŒåŠ èŒ‚æ°´æ—é¤¨ã€ãŒã‚ã‚Šã€å¹»æƒ³çš„ãªã‚¯ãƒ©ã‚²ã®ç¾¤ã‚ŒãŒè¦‹ã‚‰ã‚Œã‚‹ã€‚",
        "2. ã€ŒèŠ‹ç…®ä¼šã€ã¯å±±å½¢çœŒã®ç§‹ã®é¢¨ç‰©è©©ã§ã€æ²³åŸã§å·¨å¤§ãªé‹ã‚’å›²ã‚“ã§èŠ‹ç…®ã‚’é£Ÿã¹ã‚‹ç¿’æ…£ãŒã‚ã‚‹ã€‚",
        "3. ã•ãã‚‰ã‚“ã¼ï¼ˆä½è—¤éŒ¦ï¼‰ã®ç¾å‘³ã—ã•ã¯æ ¼åˆ¥ã§ã™ãŒã€ç¨®ã‚’é£›ã°ã™è·é›¢ã‚’ç«¶ã†ã€Œã•ãã‚‰ã‚“ã¼ç¨®é£›ã°ã—å¤§ä¼šã€ã‚‚ç†±ã„ï¼"
    ],
    'ç¦å³¶çœŒ': [
        # æ¾å³¶ã§ã¯ãªãã€èµ¤ã¹ã“ã¨å–œå¤šæ–¹ãƒ©ãƒ¼ãƒ¡ãƒ³ã€ä¸‰æ˜¥æ»æ¡œã«é–¢ã™ã‚‹æƒ…å ±ã«ä¿®æ­£
        "1. ç¦å³¶çœŒä¼šæ´¥åœ°æ–¹ã®éƒ·åœŸç©å…·ã€Œèµ¤ã¹ã“ã€ã¯ã€å„é™¤ã‘ã‚„ç–«ç—…é™¤ã‘ã¨ã—ã¦è¦ªã—ã¾ã‚Œã¦ããŸã€‚é¦–ã‚’æŒ¯ã‚‹å§¿ãŒæ„›ã‚‰ã—ã„ã€‚",
        "2. ã€Œå–œå¤šæ–¹ãƒ©ãƒ¼ãƒ¡ãƒ³ã€ã¯ã€å¹³æ‰“ã¡å¤ªéººã¨ã‚ã£ã•ã‚Šé†¤æ²¹ã‚¹ãƒ¼ãƒ—ãŒç‰¹å¾´ã§ã€æ—¥æœ¬ä¸‰å¤§ãƒ©ãƒ¼ãƒ¡ãƒ³ã®ä¸€ã¤ã€‚",
        "3. æ—¥æœ¬ä¸‰å¤§æ¡œã®ä¸€ã¤ã§ã‚ã‚‹ã€Œä¸‰æ˜¥æ»æ¡œã€ã¯ã€æ¨¹é½¢1000å¹´ä»¥ä¸Šã®ãƒ™ãƒ‹ã‚·ãƒ€ãƒ¬ã‚¶ã‚¯ãƒ©ã€‚ãã®é›„å¤§ã•ã¯åœ§å·»ã§ã™ã€‚"
    ],
    'èŒ¨åŸçœŒ': [
        "1. èŒ¨åŸçœŒã¯ã€å…¨å›½ã§æœ€ã‚‚ç´è±†ã®æ¶ˆè²»é‡ãŒå¤šã„ã“ã¨ã§çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ã€‚æœé£Ÿã¯ç´è±†ãŒå®šç•ªã€‚",
        "2. ã‚®ãƒã‚¹è¨˜éŒ²ã«ã‚‚èªå®šã•ã‚ŒãŸä¸–ç•Œæœ€å¤§ã®ç‰›ä¹…å¤§ä»ã¯ã€é ãã‹ã‚‰ã§ã‚‚ãã®å¤§ãã•ã«åœ§å€’ã•ã‚Œã‚‹ã€‚",
        "3. èŒ¨åŸã«ã¯æµ·ãŒã‚ã‚Šã¾ã™ãŒã€çœŒæ°‘ã¯ã€Œæµ·ãªã—çœŒã€ã ã¨è‡ªè™ãƒã‚¿ã«ã—ãŒã¡ã€‚é­…åŠ›åº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®ã›ã„ã‹ã‚‚ã€‚"
    ],
    'æ ƒæœ¨çœŒ': [
        "1. æ ƒæœ¨çœŒã¯ã€é¤ƒå­ã®æ¶ˆè²»é‡ã§å®‡éƒ½å®®å¸‚ãŒå…¨å›½ãƒˆãƒƒãƒ—äº‰ã„ã‚’ã™ã‚‹ã»ã©é¤ƒå­æ„›ãŒå¼·ã„ã€‚",
        "2. ã€Œãƒ¬ãƒ¢ãƒ³ç‰›ä¹³ã€ã¨ã„ã†ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªé£²ã¿ç‰©ãŒã‚½ã‚¦ãƒ«ãƒ‰ãƒªãƒ³ã‚¯ã€‚ãƒ¬ãƒ¢ãƒ³å‘³ãªã®ã«ç‰›ä¹³ã§ã§ãã¦ã„ã‚‹ã€‚",
        "3. æ ƒæœ¨ã«ã¯æ¸©æ³‰åœ°ãŒå¤šã„ã§ã™ãŒã€è¦³å…‰å®¢ãŒã€Œæ—¥å…‰ã€ã¨ã€Œé‚£é ˆã€ä»¥å¤–ã‚’çŸ¥ã‚‰ãªã„ã¨å˜†ãäººãŒã„ã‚‹ã€‚"
    ],
    'ç¾¤é¦¬çœŒ': [
        "1. ç¾¤é¦¬çœŒã«ã¯ã€æ¸©æ³‰åœ°ãŒå¤šãã€ç‰¹ã«è‰æ´¥æ¸©æ³‰ã¯ã€Œæ¹¯ã‚‚ã¿ã€ã¨ã„ã†ä¼çµ±çš„ãªå…¥æµ´æ³•ãŒæœ‰åã€‚",
        "2. ã€Œå³ ã®é‡œã‚ã—ã€ã¯ã€å³ è¶Šãˆã®éš›ã«é£Ÿã¹ã‚‹é§…å¼ã¨ã—ã¦äººæ°—ãŒé«˜ã„ã€‚",
        "3. è¤‡é›‘ãªåœ°å½¢ã®ãŸã‚ã€çœŒæ°‘ã¯ã€Œç¾¤é¦¬ã¯åœ°å›³ã§è¦‹ã‚‹ã¨é¶´ã®å½¢ã‚’ã—ã¦ã„ã‚‹ã€ã¨ã„ã†è±†çŸ¥è­˜ã‚’æŠ«éœ²ã—ãŒã¡ã€‚"
    ],
    'åŸ¼ç‰çœŒ': [
        "1. åŸ¼ç‰çœŒã«ã¯ã€æ—¥æœ¬ã§å”¯ä¸€ã®ã€Œé‰„é“åšç‰©é¤¨ã€ãŒã‚ã‚Šã€é‰„é“ãƒ•ã‚¡ãƒ³ã«ã¯ãŸã¾ã‚‰ãªã„è–åœ°ã€‚",
        "2. ã€Œè‰åŠ ã›ã‚“ã¹ã„ã€ã¯ã€æ‰‹ç„¼ãã®æŠ€è¡“ãŒå—ã‘ç¶™ãŒã‚Œã€ãƒ‘ãƒªãƒ‘ãƒªã¨ã—ãŸé£Ÿæ„ŸãŒãŸã¾ã‚‰ãªã„ã€‚",
        "3. åŸ¼ç‰çœŒæ°‘ã¯ã€æ±äº¬ã«å‡ºã‚‹ã“ã¨ã‚’ã€Œä¸Šäº¬ã€ã§ã¯ãªãã€Œã¡ã‚‡ã£ã¨éƒ½å†…ã¸ã€ã¨å‘¼ã³ã€éƒ½æ°‘æ„è­˜ãŒé«˜ã„ã¨å†—è«‡ã§è¨€ã‚ã‚Œã‚‹ã€‚"
    ],
    'åƒè‘‰çœŒ': [
        "1. åƒè‘‰çœŒã«ã¯ã€ä¸–ç•Œæœ€å¤§ã®ãƒã‚ºãƒŸç‹å›½ã€Œæ±äº¬ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒªã‚¾ãƒ¼ãƒˆã€ãŒã‚ã‚‹ãŒã€ä½æ‰€ã¯åƒè‘‰çœŒæµ¦å®‰å¸‚ã€‚",
        "2. æˆ¿ç·åŠå³¶ã¯æ¸©æš–ãªæ°—å€™ã§ã€å†¬ã§ã‚‚èœã®èŠ±ãŒå’²ãä¹±ã‚Œã‚‹ã€‚",
        "3. åƒè‘‰çœŒæ°‘ã¯ã€æ±äº¬ã®è¦³å…‰åœ°ã‚’ã€Œã†ã¡ã®çœŒã«ã‚ã‚‹ã€ã¨ä¸»å¼µã—ãŒã¡ã€‚TDRã¯ãã®ç­†é ­ã§ã™ã€‚"
    ],
    'æ±äº¬éƒ½': [
        "1. æ¸‹è°·ã®ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®ç‚¹ã¯ã€ä¸€åº¦ã«æœ€å¤§3,000äººãŒæ¨ªæ–­ã™ã‚‹ã¨è¨€ã‚ã‚Œã‚‹ä¸–ç•Œæœ‰æ•°ã®äº¤å·®ç‚¹ã€‚",
        "2. 23åŒºå¤–ã®å¤šæ‘©åœ°åŸŸã«ã‚ã‚‹å¥¥å¤šæ‘©ã¯ã€å®Ÿã¯è‡ªç„¶è±Šã‹ã§ãƒã‚¤ã‚­ãƒ³ã‚°ã‚„ã‚­ãƒ£ãƒ³ãƒ—ãŒæ¥½ã—ã‚ã‚‹ã€‚",
        "3. æ±äº¬ã®ã‚¿ã‚¯ã‚·ãƒ¼ã®é‹è»¢æ‰‹ã¯ã€ã©ã“ã§ã‚‚ã€Œã ã„ãŸã„ã€çŸ¥ã£ã¦ã„ã‚‹ãŒã€å…·ä½“çš„ãªé“é †ã‚’èãã¨å›°ã‚‹ã‚‰ã—ã„ã€‚"
    ],
    'ç¥å¥ˆå·çœŒ': [
        "1. æ¨ªæµœä¸­è¯è¡—ã¯ã€æ—¥æœ¬æœ€å¤§ã®ä¸­è¯è¡—ã§ã€æ§˜ã€…ãªæœ¬å ´ã®ä¸­è¯æ–™ç†ãŒæ¥½ã—ã‚ã‚‹ã€‚",
        "2. éŒå€‰ã®å¤§ä»ã¯ã€æµ·ã‚’æœ›ã‚€é«˜å°ã«ã‚ã‚Šã€ãã®å·¨å¤§ã•ã¨ç©ã‚„ã‹ãªè¡¨æƒ…ãŒå°è±¡çš„ã€‚",
        "3. ã€Œæ¨ªæµœç”Ÿã¾ã‚Œã€ã¨ã„ã†è¨€è‘‰ã®éŸ¿ãã ã‘ã§ã€ãªãœã‹ãŠã—ã‚ƒã‚Œã«èã“ãˆã‚‹ãƒã‚¸ãƒƒã‚¯ãŒã‚ã‚‹ã€‚"
    ],
    'æ–°æ½ŸçœŒ': [
        "1. æ–°æ½ŸçœŒã«ã¯ã€æ—¥æœ¬æœ€é•·ã®å¤§æ²³ã€Œä¿¡æ¿ƒå·ã€ãŒæµã‚Œã¦ãŠã‚Šã€è±Šã‹ãªæ°´è³‡æºã«æµã¾ã‚Œã¦ã„ã‚‹ã€‚",
        "2. ã€Œã¸ããã°ã€ã¯ã€ã¤ãªãã«æµ·è—»ã‚’ä½¿ã£ãŸç‹¬ç‰¹ã®ãã°ã§ã€ãƒ„ãƒ«ãƒ„ãƒ«ã¨ã—ãŸé£Ÿæ„ŸãŒç‰¹å¾´ã€‚",
        "3. é›ªå›½ã§ã¯ã€å†¬ã®é–“ã€ç„é–¢å‰ã®é›ªã‹ãã‚’æ€ ã‚‹ã¨è¿‘æ‰€ã‹ã‚‰ã®ç„¡è¨€ã®åœ§åŠ›ãŒã™ã”ã„ã€‚"
    ],
    'å¯Œå±±çœŒ': [
        "1. å¯Œå±±çœŒã¯ã€æŒã¡å®¶ç‡ãŒå…¨å›½ã§æœ€ã‚‚é«˜ã„çœŒã®ä¸€ã¤ã§ã€ä½å®…ã¸ã®ã“ã ã‚ã‚ŠãŒå¼·ã„ã€‚",
        "2. ç«‹å±±é»’éƒ¨ã‚¢ãƒ«ãƒšãƒ³ãƒ«ãƒ¼ãƒˆã®ã€Œé›ªã®å¤§è°·ã€ã¯ã€æ˜¥ã«ãªã‚‹ã¨20mè¿‘ã„é›ªã®å£ãŒããã‚Šç«‹ã¤ã€‚",
        "3. å¯’ã„å†¬ã«ã¯ã€Œå¯Œå±±ã®å¯’ãƒ–ãƒªã€ãŒçµ¶å“ã§ã™ãŒã€é£Ÿã¹ã™ãã¦ã€Œãƒ–ãƒªã€ã«ãªã£ã¦ã‚‚è²¬ä»»ã¯è² ã„ã¾ã›ã‚“ã€‚"
    ],
    'çŸ³å·çœŒ': [
        "1. é‡‘æ²¢å¸‚ã¯ã€åŠ è³€ç™¾ä¸‡çŸ³ã®æ­´å²ã‚’æŒã¤åŸä¸‹ç”ºã§ã€é¢¨æƒ…ã‚ã‚‹è¡—ä¸¦ã¿ãŒæ®‹ã‚‹ã€‚",
        "2. ã€Œå…¼å…­åœ’ã€ã¯ã€æ±Ÿæˆ¸æ™‚ä»£ã®ä»£è¡¨çš„ãªå¤§ååº­åœ’ã§ã€å››å­£æŠ˜ã€…ã®ç¾ã—ã•ãŒæ¥½ã—ã‚ã‚‹ã€‚",
        "3. é‡‘æ²¢ã®ãŠå¯¿å¸ã¯æœ€é«˜ã«ç¾å‘³ã—ã„ã®ã§ã™ãŒã€å›è»¢å¯¿å¸ã§ã‚‚ãƒ¬ãƒ™ãƒ«ãŒé«˜ã™ãã¦é©šãã“ã¨ãŒå¤šã„ã€‚"
    ],
    'ç¦äº•çœŒ': [
        "1. ç¦äº•çœŒã¯ã€æç«œã®åŒ–çŸ³ãŒå¤šãç™ºæ˜ã•ã‚Œã¦ãŠã‚Šã€æç«œåšç‰©é¤¨ã¯ä¸–ç•Œçš„ã«æœ‰åã€‚",
        "2. ã€Œè¶Šå‰ã‚¬ãƒ‹ã€ã¯ã€å†¬ã®å‘³è¦šã®ç‹æ§˜ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã€æ¿ƒåšãªå‘³ã‚ã„ãŒç‰¹å¾´ã€‚",
        "3. ç¦äº•çœŒæ°‘ã¯ã€ãŠã‚ã—ãã°ã«ç•°å¸¸ãªã“ã ã‚ã‚Šã‚’æŒã¤ã€‚ã€Œè•éº¦ã«ã¯å¤§æ ¹ãŠã‚ã—ã‚’ã‹ã‘ã‚‹ã®ãŒå¸¸è­˜ã€ã¨ä¿¡ã˜ã¦ãŠã‚Šã€æ¸©ã‹ã„è•éº¦ã‚ˆã‚Šå†·ãŸã„ãŠã‚ã—è•éº¦ã‚’å¥½ã‚€å‚¾å‘ã«ã‚ã‚‹ã€‚"
    ],
    'å±±æ¢¨çœŒ': [
        "1. å±±æ¢¨çœŒã¯ã€å¯Œå£«å±±ã ã‘ã§ãªãã€å—ã‚¢ãƒ«ãƒ—ã‚¹ãªã©é›„å¤§ãªè‡ªç„¶ã«å›²ã¾ã‚Œã¦ã„ã‚‹ã€‚",
        "2. ã€Œã»ã†ã¨ã†ã€ã¯ã€å¤ªã„éººã¨é‡èœã‚’å‘³å™Œã§ç…®è¾¼ã‚“ã éƒ·åœŸæ–™ç†ã§ã€ä½“ãŒæ¸©ã¾ã‚‹ã€‚",
        "3. å¯Œå£«å±±ã¯é™å²¡çœŒã¨ã®å…±æœ‰ç‰©ã§ã™ãŒã€å±±æ¢¨å´ã‹ã‚‰ã®æ™¯è‰²ãŒä¸€ç•ªã ã¨ã„ã†å¼·ã„ã“ã ã‚ã‚Šã‚’æŒã¤äººãŒå¤šã„ã€‚"
    ],
    'é•·é‡çœŒ': [
        "1. é•·é‡çœŒã¯ã€æ—¥æœ¬ã‚¢ãƒ«ãƒ—ã‚¹ã«å›²ã¾ã‚Œã€ã€Œæ—¥æœ¬ã®å±‹æ ¹ã€ã¨å‘¼ã°ã‚Œã‚‹ã€‚",
        "2. å–„å…‰å¯ºã®ã€ŒãŠæˆ’å£‡å·¡ã‚Šã€ã¯ã€çœŸã£æš—ãªé€šè·¯ã‚’æ‰‹æ¢ã‚Šã§é€²ã‚€ã¨ã„ã†ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªä½“é¨“ã€‚",
        "3. é•·é‡çœŒæ°‘ã¯ã€ŒãŠã‚„ãã€ã¨ã„ã†é£Ÿã¹ç‰©ã‚’ã“ã‚ˆãªãæ„›ã—ã¦ãŠã‚Šã€ä¸­èº«ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ãŒè±Šå¯Œã™ãã‚‹ã€‚"
    ],
    'å²é˜œçœŒ': [
        "1. ä¸–ç•Œéºç”£ã€Œç™½å·éƒ·ã€ã®åˆæŒé€ ã‚Šé›†è½ã¯ã€é›ªæ·±ã„å±±é–“éƒ¨ã«ã‚ã‚‹ç‹¬ç‰¹ã®å»ºç¯‰æ§˜å¼ã€‚",
        "2. å²é˜œçœŒé–¢å¸‚ã¯ã€éŒå€‰æ™‚ä»£ã‹ã‚‰ç¶šãåˆƒç‰©ã¥ãã‚Šã®ä¼çµ±ãŒã‚ã‚Šã€ã€Œé–¢ã®å­«å…­ã€ãŒæœ‰åã€‚",
        "3. ã€Œå²é˜œã£ã¦ã©ã“ã«ã‚ã‚‹ã®ï¼Ÿã€ã¨èã‹ã‚Œã‚‹ã¨ã€çœŒæ°‘ã¯ã€Œæ„›çŸ¥ã®ä¸Šï¼ã€ã¨å³ç­”ã—ãŒã¡ã€‚"
    ],
    'é™å²¡çœŒ': [
        "1. é™å²¡çœŒã¯ã€ãŠèŒ¶ã®ç”Ÿç”£é‡ãŒå…¨å›½ãƒˆãƒƒãƒ—ã§ã€ç·‘èŒ¶ã®é¦™ã‚ŠãŒè¡—ä¸­ã«æ¼‚ã†ã€‚",
        "2. ã€Œã•ã‚ã‚„ã‹ã€ã¨ã„ã†ãƒãƒ³ãƒãƒ¼ã‚°ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ãŒæœ‰åã§ã€ç†±ç‹‚çš„ãªãƒ•ã‚¡ãƒ³ãŒå¤šã„ã€‚",
        "3. ã€Œã•ã‚ã‚„ã‹ã€ã®ãƒãƒ³ãƒãƒ¼ã‚°ã®ãŸã‚ã«ã€é™å²¡çœŒå¤–ã‹ã‚‰æ¥ã‚‹å®¢ãŒå¤šã™ãã¦ã€åœ°å…ƒæ°‘ãŒé£Ÿã¹ã‚‰ã‚Œãªããªã‚‹å•é¡ŒãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã€‚"
    ],
    'æ„›çŸ¥çœŒ': [
        "1. åå¤å±‹å¸‚ã¯ã€ç‹¬è‡ªã®é£Ÿæ–‡åŒ–ã€Œåå¤å±‹ã‚ã—ã€ãŒã‚ã‚Šã€å‘³å™Œã‚«ãƒ„ã€æ‰‹ç¾½å…ˆã€ã²ã¤ã¾ã¶ã—ãªã©ãŒæœ‰åã€‚",
        "2. æ„›çŸ¥çœŒæ°‘ã¯ã€å–«èŒ¶åº—ã§ã®ãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°æ–‡åŒ–ã‚’æ„›ã—ã¦ãŠã‚Šã€æœé£Ÿã«è±ªè¯ãªã‚µãƒ¼ãƒ“ã‚¹ãŒä»˜ãã“ã¨ãŒå¤šã„ã€‚",
        "3. æ„›çŸ¥çœŒæ°‘ã¯ã€èµ¤å‘³å™Œãªã—ã§ã¯ç”Ÿãã¦ã„ã‘ãªã„ã¨å†—è«‡ã§è¨€ã‚ã‚Œã‚‹ã»ã©ã€å‘³å™Œæ„›ãŒå¼·ã„ã€‚"
    ],
    'ä¸‰é‡çœŒ': [
        "1. ä¼Šå‹¢ç¥å®®ã¯ã€æ—¥æœ¬äººã®å¿ƒã®ãµã‚‹ã•ã¨ã¨è¨€ã‚ã‚Œã€æ¯å¹´å¤šãã®å‚æ‹è€…ãŒè¨ªã‚Œã‚‹ã€‚",
        "2. ã€Œä¼Šè³€æµå¿è€…åšç‰©é¤¨ã€ã§ã¯ã€å¿è€…ã®ç§˜å¯†ã‚„é“å…·ãŒå±•ç¤ºã•ã‚Œã¦ãŠã‚Šã€ä¿®è¡Œä½“é¨“ã‚‚å¯èƒ½ã€‚",
        "3. ä¸‰é‡çœŒã¯é–¢è¥¿ãªã®ã‹æ±æµ·ãªã®ã‹ã€çœŒæ°‘è‡ªèº«ã‚‚ã‚ˆãã‚ã‹ã‚‰ãªããªã‚‹ã¨ããŒã‚ã‚‹ã€‚"
    ],
    'æ»‹è³€çœŒ': [
        "1. çµç¶æ¹–ã¯æ—¥æœ¬æœ€å¤§ã®æ¹–ã§ã‚ã‚Šã€æ»‹è³€çœŒæ°‘ã«ã¨ã£ã¦ãªãã¦ã¯ãªã‚‰ãªã„å­˜åœ¨ã€‚",
        "2. çµç¶æ¹–ã«ã¯ã€å›ºæœ‰ç¨®ãŒå¤šãç”Ÿæ¯ã—ã¦ãŠã‚Šã€ã€Œçµç¶æ¹–ã®å®çŸ³ã€ã¨å‘¼ã°ã‚Œã‚‹é­šã‚‚ã„ã‚‹ã€‚",
        "3. æ»‹è³€çœŒæ°‘ã«ã¨ã£ã¦ã€çµç¶æ¹–ã¯ã€Œæ°´é“æ°´ã€ã€Œå¤©æ°—äºˆå ±ã€ã€Œãƒ¬ã‚¸ãƒ£ãƒ¼æ–½è¨­ã€ã®å…¨ã¦ã§ã‚ã‚‹ã€‚"
    ],
    'äº¬éƒ½åºœ': [
        "1. ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ã¯ã€äº¬éƒ½ã¯å·¦å´ã€å¤§é˜ªã¯å³å´ã«ç«‹ã¤å‚¾å‘ãŒã‚ã‚‹ãŸã‚ã€é–¢è¥¿å†…ã§ã‚‚æ··ä¹±ã—ãŒã¡ã€‚",
        "2. ã€Œç¥‡åœ’ç¥­ã€ã¯ã€1000å¹´ä»¥ä¸Šã®æ­´å²ã‚’æŒã¤ç¥­ã‚Šã§ã€å±±é‰¾å·¡è¡Œã¯è±ªè¯çµ¢çˆ›ã€‚",
        "3. äº¬éƒ½äººã¯ã€ä»–äººã‚’è¤’ã‚ã‚‹ã¨ãã‚‚é å›ã—ã™ãã¦ã€è¤’ã‚ã¦ã„ã‚‹ã®ã‹çš®è‚‰ãªã®ã‹åˆ†ã‹ã‚‰ãªããªã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚"
    ],
    'å¤§é˜ªåºœ': [
        "1. å¤§é˜ªã®ãŠã°ã¡ã‚ƒã‚“ã¯ã€æ´¾æ‰‹ãªæœè£…ã¨ã€Œã‚¢ãƒ¡ã¡ã‚ƒã‚“ã€ã‚’é…ã‚‹æ–‡åŒ–ãŒä»£åè©ã€‚",
        "2. ã€Œãã„ã ãŠã‚Œã®è¡—ã€ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã€ãŸã“ç„¼ãã€ãŠå¥½ã¿ç„¼ãã€ä¸²ã‚«ãƒ„ãªã©ã€ç²‰ã‚‚ã‚“æ–‡åŒ–ãŒç™ºé”ã€‚",
        "3. å¤§é˜ªäººã¯ã€åˆå¯¾é¢ã®ç›¸æ‰‹ã«ã‚‚å¹³æ°—ã§ãƒ„ãƒƒã‚³ãƒŸã‚’å…¥ã‚Œã‚‹ãŒã€ãã‚Œã¯æ„›æƒ…è¡¨ç¾ã®ä¸€ã¤ã§ã‚ã‚‹ã€‚"
    ],
    'å…µåº«çœŒ': [
        "1. ç¥æˆ¸å¸‚ã®ç•°äººé¤¨è¡—ã¯ã€æ˜æ²»æ™‚ä»£ã«å»ºã¦ã‚‰ã‚ŒãŸæ´‹é¢¨å»ºç¯‰ãŒç«‹ã¡ä¸¦ã³ã€ç•°å›½æƒ…ç·’ãŒæ¼‚ã†ã€‚",
        "2. ã€Œæ·¡è·¯å³¶ã€ã¯ã€æ—¥æœ¬æ›¸ç´€ã«ç™»å ´ã™ã‚‹ã€Œå›½ç”Ÿã¿ç¥è©±ã€ã®èˆå°ã€‚",
        "3. å…µåº«çœŒæ°‘ã¯ã€è‡ªåˆ†ãŸã¡ã®ã“ã¨ã‚’ã€Œç¥æˆ¸ã®äººã€ã¨ç´¹ä»‹ã—ãŒã¡ã€‚ãªãœã‹ã€Œå…µåº«ã€ã¨ã¯è¨€ã‚ãªã„ã€‚"
    ],
    'å¥ˆè‰¯çœŒ': [
        "1. å¥ˆè‰¯å…¬åœ’ã®é¹¿ã¯ã€å¤©ç„¶è¨˜å¿µç‰©ã¨ã—ã¦ä¿è­·ã•ã‚Œã¦ãŠã‚Šã€äººæ‡ã£ã“ãã›ã‚“ã¹ã„ã‚’ã­ã ã‚‹ã€‚",
        "2. æ±å¤§å¯ºã®å¤§ä»æ®¿ã¯ã€ä¸–ç•Œæœ€å¤§ã®æœ¨é€ å»ºç¯‰ç‰©ã€‚",
        "3. å¥ˆè‰¯ã®é¹¿ã¯ã€ã›ã‚“ã¹ã„ã‚’æŒã£ã¦ã„ã‚‹ã¨å¯ŸçŸ¥ã™ã‚‹èƒ½åŠ›ãŒé«˜ã™ãã‚‹ã€‚ã¾ã•ã«é‡ç”Ÿã®ã‚«ãƒ³ã€‚"
    ],
    'å’Œæ­Œå±±çœŒ': [
        "1. ç†Šé‡å¤é“ã¯ã€ä¸–ç•Œéºç”£ã«ç™»éŒ²ã•ã‚ŒãŸå·¡ç¤¼è·¯ã§ã€ç¥ç§˜çš„ãªé›°å›²æ°—ãŒæ¼‚ã†ã€‚",
        "2. å’Œæ­Œå±±çœŒã¯ã€ã¿ã‹ã‚“ã®ç”Ÿç”£é‡ãŒå…¨å›½ãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹ã§ã€æ§˜ã€…ãªå“ç¨®ãŒæ ½åŸ¹ã•ã‚Œã¦ã„ã‚‹ã€‚",
        "3. å’Œæ­Œå±±ã¯ã€Œã¿ã‹ã‚“ç‹å›½ã€ã§ã‚ã‚Šã€è‡ªå®…ã®åº­ã«ã¿ã‹ã‚“ã®æœ¨ãŒã‚ã‚‹å®¶ãŒå¤šãã€å†¬å ´ã¯ã¿ã‹ã‚“ã®æ¶ˆè²»é‡ãŒå°‹å¸¸ã§ã¯ãªã„ã€‚"
    ],
    'é³¥å–çœŒ': [
        "1. é³¥å–ç ‚ä¸˜ã¯ã€æ—¥æœ¬æœ€å¤§ã®ç ‚ä¸˜ã§ã€ã¾ã‚‹ã§ç ‚æ¼ ã®ã‚ˆã†ãªå£®å¤§ãªæ™¯è‰²ãŒåºƒãŒã‚‹ã€‚",
        "2. æ¼«ç”»å®¶ãƒ»æ°´æœ¨ã—ã’ã‚‹ã®å‡ºèº«åœ°ã§ã€ã€Œæ°´æœ¨ã—ã’ã‚‹ãƒ­ãƒ¼ãƒ‰ã€ã«ã¯å¦–æ€ªã®ãƒ–ãƒ­ãƒ³ã‚ºåƒãŒä¸¦ã¶ã€‚",
        "3. é³¥å–çœŒã«ã¯ã€Œã‚¹ã‚¿ãƒã¯ãªã„ã‘ã©ç ‚å ´ã¯ã‚ã‚‹ã€ã¨ã„ã†è‡ªè™ãƒã‚¿ãŒã‚ã‚‹ãŒã€ä»Šã¯ã‚¹ã‚¿ãƒã‚‚ã‚ã‚‹ã€‚"
    ],
    'å³¶æ ¹çœŒ': [
        "1. ã€Œå‡ºé›²å¤§ç¤¾ã€ã¯ã€æ—¥æœ¬ä¸­ã®ç¥æ§˜ãŒé›†ã¾ã‚‹ã€Œç¥åœ¨æœˆã€ï¼ˆæ—§æš¦10æœˆï¼‰ã§çŸ¥ã‚‰ã‚Œã‚‹ã€‚",
        "2. å³¶æ ¹çœŒã§ã¯ã€æµ·å¥³ã•ã‚“ãŒç´ æ½œã‚Šã§æµ·ç”£ç‰©ã‚’æ¡ã‚‹ä¼çµ±ãŒæ®‹ã£ã¦ã„ã‚‹ã€‚",
        "3. å³¶æ ¹çœŒæ°‘ã¯ã€é³¥å–çœŒæ°‘ã¨é–“é•ãˆã‚‰ã‚Œã‚‹ã¨ã€ã‹ãªã‚Šè¤‡é›‘ãªæ°—æŒã¡ã«ãªã‚‹ã‚‰ã—ã„ã€‚"
    ],
    'å²¡å±±çœŒ': [
        "1. å²¡å±±çœŒã¯ã€Œæ™´ã‚Œã®å›½ã€ã¨å‘¼ã°ã‚Œã€å¹´é–“ã‚’é€šã˜ã¦æ™´å¤©ãŒå¤šã„ã€‚",
        "2. ã€Œæ¡ƒå¤ªéƒä¼èª¬ã€ã®ç™ºç¥¥åœ°ã®ä¸€ã¤ã¨ã•ã‚Œã€é–¢é€£ã™ã‚‹å²è·¡ãŒå¤šãæ®‹ã‚‹ã€‚",
        "3. å²¡å±±å¼ã¯èªå°¾ã«ã€Œã˜ã‚ƒã€ã‚’ã‚ˆãä½¿ã†ãŸã‚ã€ã‚±ãƒ³ã‚«ã—ã¦ã„ã‚‹ã‚ˆã†ã«èã“ãˆã‚‹ã“ã¨ãŒã‚ã‚‹ãŒã€å®Ÿã¯æ—¥å¸¸ä¼šè©±ã§ã‚ã‚‹ã€‚"
    ],
    'åºƒå³¶çœŒ': [
        "1. ã€Œå³å³¶ç¥ç¤¾ã€ã®æµ·ã«æµ®ã‹ã¶å¤§é³¥å±…ã¯ã€å¹²æ½®æ™‚ã«ã¯æ­©ã„ã¦ããã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚",
        "2. åºƒå³¶é¢¨ãŠå¥½ã¿ç„¼ãã¯ã€ãã°ã‚„ã†ã©ã‚“ãŒå…¥ã‚‹ã®ãŒç‰¹å¾´ã§ã€ãƒœãƒªãƒ¥ãƒ¼ãƒ æº€ç‚¹ã€‚",
        "3. åºƒå³¶æ±æ´‹ã‚«ãƒ¼ãƒ—ã®è©¦åˆã¯ã€åœ°å…ƒæ°‘ã«ã¨ã£ã¦ã‚¹ãƒãƒ¼ãƒ„è¦³æˆ¦ã§ã¯ãªãã€Œç¥­ã‚Šã€ã§ã‚ã‚‹ã€‚"
    ],
    'å±±å£çœŒ': [
        "1. ã€ŒéŒ¦å¸¯æ©‹ã€ã¯ã€æœ¨é€ ã®äº”é€£ã‚¢ãƒ¼ãƒæ©‹ã§ã€ãã®å„ªç¾ãªå§¿ã¯æ—¥æœ¬ä¸‰åæ©‹ã®ä¸€ã¤ã€‚",
        "2. å±±å£çœŒã¯ã€ãµãã®å–æ‰±é‡ãŒå…¨å›½ãƒˆãƒƒãƒ—ã§ã€ç‰¹ã«ä¸‹é–¢ã®ã€Œã¨ã‚‰ãµãã€ãŒæœ‰åã€‚",
        "3. å±±å£çœŒã¯ã€Œæœ¬å·ã®ç«¯ã£ã“ã€ã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå¼·ã™ãã¦ã€ã©ã“ã«è¡Œãã«ã‚‚é ã„ã¨ã„ã†å®¿å‘½ã‚’èƒŒè² ã£ã¦ã„ã‚‹ã€‚"
    ],
    'å¾³å³¶çœŒ': [
        "1. ã€Œé˜¿æ³¢ãŠã©ã‚Šã€ã¯ã€æ—¥æœ¬ã‚’ä»£è¡¨ã™ã‚‹ç›†è¸Šã‚Šã§ã€è¡—ä¸­ãŒç†±ç‹‚çš„ãªè¸Šã‚Šã«åŒ…ã¾ã‚Œã‚‹ã€‚",
        "2. ã€Œé³´é–€ã®æ¸¦æ½®ã€ã¯ã€æ½®ã®å¹²æº€ã«ã‚ˆã£ã¦ç™ºç”Ÿã™ã‚‹ä¸–ç•Œæœ€å¤§ç´šã®æ¸¦æ½®ã€‚",
        "3. å¾³å³¶çœŒæ°‘ã¯ã€é˜¿æ³¢ãŠã©ã‚Šã®å­£ç¯€ãŒè¿‘ã¥ãã¨ã€è¡€ãŒé¨’ã„ã§è¸Šã‚Šã ã—ãŸããªã‚‹è¡å‹•ã«é§†ã‚‰ã‚Œã‚‹ã€‚"
    ],
    'é¦™å·çœŒ': [
        "1. ã€Œè®ƒå²ã†ã©ã‚“ã€ã¯ã€ã‚³ã‚·ã®å¼·ã•ãŒç‰¹å¾´ã§ã€æ‰‹æ‰“ã¡ã†ã©ã‚“åº—ãŒå¤šæ•°å­˜åœ¨ã™ã‚‹ã€‚",
        "2. é¦™å·çœŒã¯ã€é¢ç©ãŒæ—¥æœ¬ã§æœ€ã‚‚å°ã•ã„çœŒã ãŒã€è¦³å…‰è³‡æºã¯è±Šå¯Œã€‚",
        "3. é¦™å·çœŒæ°‘ã¯ã€æœé£Ÿã«ã†ã©ã‚“ã€æ˜¼é£Ÿã«ã†ã©ã‚“ã€å¤•é£Ÿã«ã†ã©ã‚“ã§ã‚‚å…¨ãå•é¡Œãªã„ã¨æ€ã£ã¦ã„ã‚‹äººãŒå¤šã„ã€‚"
    ],
    'æ„›åª›çœŒ': [
        "1. ã€Œé“å¾Œæ¸©æ³‰ã€ã¯ã€å¤ç›®æ¼±çŸ³ã®å°èª¬ã€åŠã£ã¡ã‚ƒã‚“ã€ã®èˆå°ã¨ã—ã¦ã‚‚çŸ¥ã‚‰ã‚Œã‚‹ã€‚",
        "2. æ„›åª›çœŒã¯ã€ã¿ã‹ã‚“ã®ç”Ÿç”£é‡ãŒå…¨å›½ãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹ã§ã€æ§˜ã€…ãªå“ç¨®ãŒæ ½åŸ¹ã•ã‚Œã¦ã„ã‚‹ã€‚",
        "3. æ„›åª›çœŒæ°‘ã¯ã€ã¿ã‹ã‚“ã‚’çµã£ãŸã‚¸ãƒ¥ãƒ¼ã‚¹ã‚’æ°´é“ã®è›‡å£ã‹ã‚‰å‡ºã™å¤¢ã‚’è¦‹ã¦ã„ã‚‹ã€‚"
    ],
    'é«˜çŸ¥çœŒ': [
        "1. ã€Œå‚æœ¬é¾é¦¬ã€ã®å‡ºèº«åœ°ã§ã‚ã‚Šã€å¹•æœ«ã®æ­´å²ã‚’æ„Ÿã˜ã•ã›ã‚‹å ´æ‰€ãŒå¤šã„ã€‚",
        "2. ã€Œã‚«ãƒ„ã‚ªã®ãŸãŸãã€ã¯ã€è—ç„¼ãã§è¡¨é¢ã‚’ç‚™ã‚‹ã®ãŒä¼çµ±çš„ãªèª¿ç†æ³•ã€‚",
        "3. é«˜çŸ¥çœŒæ°‘ã¯ã€ã‚«ãƒ„ã‚ªã®ãŸãŸãã‚’é£Ÿã¹ã‚‹éš›ã€ãƒ¯ãƒ©ç„¼ãã®ç…™ãŒç›®ã«æŸ“ã¿ã¦ã‚‚æˆ‘æ…¢ã™ã‚‹ã®ãŒç¾å¾³ã ã¨ä¿¡ã˜ã¦ã„ã‚‹ã€‚"
    ],
    'ç¦å²¡çœŒ': [
        "1. åšå¤šã®å±‹å°æ–‡åŒ–ã¯ã€å¤œã«ãªã‚‹ã¨å‡ºç¾ã™ã‚‹ç‹¬ç‰¹ã®é£²é£Ÿã‚¹ã‚¿ã‚¤ãƒ«ã€‚",
        "2. ã€Œã¨ã‚“ã“ã¤ãƒ©ãƒ¼ãƒ¡ãƒ³ã€ã¯ã€æ¿ƒåšãªè±šéª¨ã‚¹ãƒ¼ãƒ—ã¨æ¥µç´°éººãŒç‰¹å¾´ã§ã€å…¨å›½çš„ã«äººæ°—ã€‚",
        "3. ç¦å²¡çœŒæ°‘ã«ã¨ã£ã¦ã€ã¨ã‚“ã“ã¤ãƒ©ãƒ¼ãƒ¡ãƒ³ã®åŒ‚ã„ã¯ã€Œæ•…éƒ·ã®é¦™ã‚Šã€ã§ã‚ã‚Šã€ã¾ã£ãŸãè‡­ããªã„ã€‚"
    ],
    'ä½è³€çœŒ': [
        "1. ä½è³€çœŒã«ã¯ã€ä¸–ç•Œçš„ã«æœ‰åãªã€Œæœ‰ç”°ç„¼ã€ã‚„ã€Œä¼Šä¸‡é‡Œç„¼ã€ã®ç”£åœ°ãŒã‚ã‚‹ã€‚",
        "2. ã€Œä½è³€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒŠã‚·ãƒ§ãƒŠãƒ«ãƒãƒ«ãƒ¼ãƒ³ãƒ•ã‚§ã‚¹ã‚¿ã€ã¯ã€ã‚¢ã‚¸ã‚¢æœ€å¤§ç´šã®ç†±æ°—çƒå¤§ä¼šã€‚",
        "3. ä½è³€çœŒæ°‘ã¯ã€æœ‰æ˜æµ·ã®ã€Œãƒ ãƒ„ã‚´ãƒ­ã‚¦ã€ãŒå¯æ„›ã™ãã¦ã€é£Ÿã¹ã‚‹ã®ãŒå¿ã³ãªã„ï¼ˆã§ã‚‚é£Ÿã¹ã‚‹ï¼‰ã€‚"
    ],
    'é•·å´çœŒ': [
        "1. ã€Œè»è‰¦å³¶ã€ã¯ã€ã‹ã¤ã¦ç‚­é‰±ã§æ „ãˆãŸå³¶ã®å»ƒå¢Ÿã§ã€ä¸–ç•Œéºç”£ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã€‚",
        "2. ã€Œé•·å´ã¡ã‚ƒã‚“ã½ã‚“ã€ã¯ã€æ§˜ã€…ãªå…·æã¨å¤ªã„éººãŒç‰¹å¾´ã§ã€ç•°å›½æƒ…ç·’ãŒæ„Ÿã˜ã‚‰ã‚Œã‚‹ã€‚",
        "3. é•·å´ã®å‚é“ã¯æ€¥ã™ãã¦ã€åœ°å…ƒæ°‘ã®è¶³è…°ã¯é‰„ç­‹ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆã®ã‚ˆã†ã«é›ãˆã‚‰ã‚Œã¦ã„ã‚‹ã€‚"
    ],
    'ç†Šæœ¬çœŒ': [
        "1. ã€Œç†Šæœ¬åŸã€ã¯ã€ã€Œæ­¦è€…è¿”ã—ã€ã¨å‘¼ã°ã‚Œã‚‹ç‹¬ç‰¹ã®çŸ³å£ãŒæœ‰åã€‚",
        "2. ã€Œé˜¿è˜‡å±±ã€ã¯ã€ä¸–ç•Œæœ€å¤§ç´šã®ã‚«ãƒ«ãƒ‡ãƒ©ã‚’æŒã¤æ´»ç«å±±ã§ã€é›„å¤§ãªæ™¯è‰²ãŒåºƒãŒã‚‹ã€‚",
        "3. ç†Šæœ¬çœŒæ°‘ã¯ã€ã‚†ã‚‹ã‚­ãƒ£ãƒ©ã€Œãã¾ãƒ¢ãƒ³ã€ã‚’å´‡æ‹ã—ã¦ãŠã‚Šã€å½¼ã®å‹•å‘ã‚’å¸¸ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ã‚‹ã€‚"
    ],
    'å¤§åˆ†çœŒ': [
        "1. åˆ¥åºœæ¸©æ³‰ã®ã€Œåœ°ç„ã‚ãã‚Šã€ã¯ã€å¥‡æŠœãªè‰²ã®æ¸©æ³‰ã‚’å·¡ã‚‹ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªè¦³å…‰ã€‚",
        "2. å¤§åˆ†çœŒã¯ã€é¶è‚‰æ–™ç†ãŒæœ‰åã§ã€ã€Œã¨ã‚Šå¤©ã€ã‚„ã€Œä¸­æ´¥ã‹ã‚‰ã‚ã’ã€ãŒã‚½ã‚¦ãƒ«ãƒ•ãƒ¼ãƒ‰ã€‚",
        "3. å¤§åˆ†çœŒæ°‘ã¯ã€åœ°ç„ã‚ãã‚Šã®æ¹¯ã‘ã‚€ã‚Šã‚’è¦‹ã‚‹ã¨ã€ã€Œä»Šæ—¥ã¯å¤©æ°—ãŒã„ã„ãªã€ã¨æ„Ÿã˜ã‚‹ã€‚"
    ],
    'å®®å´çœŒ': [
        "1. å®®å´çœŒã¯ã€æ¸©æš–ãªæ°—å€™ã‚’æ´»ã‹ã—ãŸãƒãƒ³ã‚´ãƒ¼ã‚„æ—¥å‘å¤ã®æ ½åŸ¹ãŒç››ã‚“ã€‚",
        "2. ã€Œé«˜åƒç©‚å³¡ã€ã¯ã€ç¥è©±ã®èˆå°ã¨ã—ã¦ã‚‚çŸ¥ã‚‰ã‚Œã€çœŸåäº•ã®æ»ã¯çµ¶æ™¯ã€‚",
        "3. ãƒã‚­ãƒ³å—è›®ã®ã‚¿ãƒ«ã‚¿ãƒ«ã‚½ãƒ¼ã‚¹ã¯ã€å®¶åº­ã«ã‚ˆã£ã¦å‘³ãŒç•°ãªã‚Šã€ã‚¿ãƒ«ã‚¿ãƒ«ã‚½ãƒ¼ã‚¹ã®è­°è«–ã§å¤œãŒæ›´ã‘ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚"
    ],
    'é¹¿å…å³¶çœŒ': [
        "1. ã€Œæ¡œå³¶ã€ã¯ã€ç¾åœ¨ã‚‚æ´»ç™ºãªå™´ç«æ´»å‹•ã‚’ç¶šã‘ã¦ãŠã‚Šã€ç«å±±ç°ãŒé™ã‚‹æ—¥ãŒå¤šã„ã€‚",
        "2. é¹¿å…å³¶ã¯ã€é»’è±šãŒæœ‰åã§ã€ãã®è‚‰è³ªã®è‰¯ã•ã‹ã‚‰å¤šãã®æ–™ç†ã«ä½¿ã‚ã‚Œã‚‹ã€‚",
        "3. é¹¿å…å³¶çœŒæ°‘ã¯ã€é™ã£ã¦ãã‚‹ç«å±±ç°ã‚’ã€Œæ¡œå³¶ã®æµã¿ã€ã¨å‘¼ã³ã€ç°ã‚’é¿ã‘ã‚ˆã†ã¨ã¯ã—ãªã„ã€‚"
    ],
    'æ²–ç¸„çœŒ': [
        "1. æ²–ç¸„ã§ã¯ã€æ—§æš¦è¡Œäº‹ã‚’å¤§åˆ‡ã«ã™ã‚‹æ–‡åŒ–ãŒã‚ã‚Šã€æœ¬åœŸã¨ã¯ç•°ãªã‚‹ç”Ÿæ´»ç¿’æ…£ãŒæ®‹ã‚‹ã€‚",
        "2. ã€Œæ²–ç¸„ãã°ã€ã¯ã€ãã°ç²‰ã‚’ä½¿ã‚ãšå°éº¦ç²‰ã§ä½œã‚‹ç‹¬ç‰¹ã®éººæ–™ç†ã€‚",
        "3. æ²–ç¸„ã®æ™‚é–“ã®æµã‚Œã¯ã€Œã‚¦ãƒãƒŠãƒ¼ã‚¿ã‚¤ãƒ ã€ã¨å‘¼ã°ã‚Œã€äºˆå®šã‚ˆã‚Š30åˆ†é…ã‚Œã¦ã‚‚èª°ã‚‚æ°—ã«ã—ãªã„ã€‚"
    ],
}


# --- ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ï¼šãƒˆãƒªãƒ“ã‚¢ç”Ÿæˆã¨è¡¨ç¤º ---
def display_new_tip(tip_placeholder):
    """ãƒ©ãƒ³ãƒ€ãƒ ãªéƒ½é“åºœçœŒãƒˆãƒªãƒ“ã‚¢ã‚’ç”Ÿæˆã—ã€æŒ‡å®šã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã«è¡¨ç¤ºã™ã‚‹"""
    # æ–°ã—ã„ãƒ©ãƒ³ãƒ€ãƒ ãªãƒˆãƒªãƒ“ã‚¢ã‚’ç”Ÿæˆ
    selected_prefecture = random.choice(list(PREFECTURE_TIPS.keys()))
    tips_list = PREFECTURE_TIPS[selected_prefecture]
    selected_tip = random.choice(tips_list) 
    
    # æ•´å½¢ã•ã‚ŒãŸãƒˆãƒªãƒ“ã‚¢ã‹ã‚‰ã€Œ1. ã€ã€Œ2. ã€ãªã©ã®ç•ªå·ã¨ã‚¹ãƒšãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¦æœ¬æ–‡ã®ã¿ã‚’æŠ½å‡º
    selected_tip_text = selected_tip.split(". ", 1)[-1]
    
    # ä¿®æ­£ç‚¹3: è¡¨ç¤ºãƒ†ã‚­ã‚¹ãƒˆã®å¤‰æ›´
    tip_markdown = f"""
    **{selected_prefecture}** ã®ãƒˆãƒªãƒ“ã‚¢ï¼š
    * {selected_tip_text}
    """
    tip_placeholder.markdown(tip_markdown)


# --- Streamlitã‚¢ãƒ—ãƒªã®ãƒ¡ã‚¤ãƒ³å‡¦ç† ---
def main():
    st.set_page_config(layout="wide") 
    st.title("ğŸŒWhoisä¸€æ‹¬æ¤œç´¢ã‚¢ãƒ—ãƒª")
    st.markdown("IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å›½æƒ…å ±ã«åŸºã¥ãã€**ç®¡è½„ã™ã‚‹RIR**ï¼ˆJPNIC, APNIC, RIPEãªã©ï¼‰ã®ãƒªãƒ³ã‚¯ã‚’è‡ªå‹•åˆ¤å®šã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚")
    
    # --- Whois/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œç´¢ãƒªã‚½ãƒ¼ã‚¹ç‰¹æ€§æ¯”è¼ƒ (èª¬æ˜ã«ä¸€æ‹¬è¨˜è¼‰) ---
    st.markdown("""
### ğŸ” å„Whois/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œç´¢ãƒªã‚½ãƒ¼ã‚¹ã®ç‰¹æ€§æ¯”è¼ƒ

æœ¬ã‚¢ãƒ—ãƒªãŒæä¾›ã™ã‚‹å„ç¨®ãƒªãƒ³ã‚¯ã«ã¤ã„ã¦ã€ãã®ç‰¹æ€§ã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚ŠåŠ¹ç‡çš„ã«èª¿æŸ»ã‚’é€²ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

| ãƒªã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
| :--- | :--- |
| **å…¬å¼RIRãƒ¬ã‚¸ã‚¹ãƒˆãƒª** (APNIC, JPNIC, RIPEãªã©) | **æ­£ç¢ºæ€§ã€æ¨©å¨æ€§ãŒæœ€ã‚‚é«˜ã**ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®**å‰²ã‚Šå½“ã¦å…ƒæƒ…å ±**ï¼ˆçµ„ç¹”åã€é€£çµ¡å…ˆï¼‰ãŒç¢ºèªã§ãã¾ã™ã€‚ãŸã ã—ã€**JPNIC/APNIC/LACNIC/AFRINICã¯æ‰‹å‹•å…¥åŠ›ãŒå¿…è¦**ãªæ¤œç´¢ãƒšãƒ¼ã‚¸ã¸èª˜å°ã•ã‚Œã¾ã™ã€‚ |
| **VirusTotal** | **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®è©•åˆ¤**ï¼ˆãƒãƒ«ã‚¦ã‚§ã‚¢ã€æ”»æ’ƒå±¥æ­´ï¼‰ã«é–¢ã™ã‚‹æƒ…å ±ãŒè±Šå¯Œã§ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®ãƒ¬ãƒãƒ¼ãƒˆãŒé›†ç´„ã•ã‚Œã¦ã„ã¾ã™ã€‚ |
| **Whois.com / Who.is IP** | å…¬å¼RIRã®æƒ…å ±ã‚’**è¦‹ã‚„ã™ã„UIã§é›†ç´„**ã—ã¦æä¾›ã—ã¦ãŠã‚Šã€ãƒ‰ãƒ¡ã‚¤ãƒ³åã¨IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ä¸¡æ–¹ã®Whoisæ¤œç´¢ã«åˆ©ç”¨ã—ã‚„ã™ã„ã§ã™ã€‚ |
| **DomainSearch.jp / Aguse** | æ—¥æœ¬å›½å†…ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã‚Šã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã»ã‹ã€**é–¢é€£ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³åã€ãƒãƒ¼ãƒ ã‚µãƒ¼ãƒã€Webã‚µã‚¤ãƒˆã®å®‰å…¨æ€§**ã‚’è¤‡åˆçš„ã«èª¿æŸ»ã§ãã¾ã™ã€‚ |
| **IP-API** (æœ¬ã‚¢ãƒ—ãƒªã§åˆ©ç”¨) | **å›½ã€ISPåã€ã‚¸ã‚ªãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³**ã‚’é«˜é€Ÿã«å–å¾—ã§ãã€RIRå…¬å¼ãƒªãƒ³ã‚¯ã¸ã®èª˜å°ãŒå¯èƒ½ã§ã™ã€‚ |
""")
    # ------------------------------------------------------------------
    
    # --- ãƒ¢ãƒ¼ãƒ‰é¸æŠã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã‚’è¿½åŠ  ---
    display_mode = st.radio(
        "ğŸ“ çµæœã®è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„:",
        ("æ¨™æº–ãƒ¢ãƒ¼ãƒ‰ (1IP = 1è¡Œ)", "é›†ç´„ãƒ¢ãƒ¼ãƒ‰ (ISP/å›½åˆ¥ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–)"),
        horizontal=True
    )
    
    results = [] 
    
    # --- 2. ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ ---
    uploaded_file = st.file_uploader("IP/ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒªã‚¹ãƒˆã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ (1è¡Œã«1ã¤ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ)", type=['txt'])

    if uploaded_file is not None:
        targets = uploaded_file.read().decode("utf-8").splitlines()
        targets = [t.strip() for t in targets if t.strip()]
        
        st.write(f"âœ… **èª­ã¿è¾¼ã¿å®Œäº†:** **{len(targets)}** ä»¶ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚")

        # 4. æ¤œç´¢å®Ÿè¡Œãƒœã‚¿ãƒ³
        if st.button("ğŸš€Whoisæ¤œç´¢å®Ÿè¡Œ"):
            
            # --- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã¨é€²æ—è¡¨ç¤ºé ˜åŸŸã‚’ç¢ºä¿ ---
            st.subheader("å‡¦ç†é€²æ—")
            status_placeholder = st.empty()
            progress_placeholder = st.empty()
            
            # --- å¾…ã¡æ™‚é–“ä¸­ã®éƒ½é“åºœçœŒè±†çŸ¥è­˜ã‚’è¡¨ç¤ºã™ã‚‹é ˜åŸŸã‚’ç¢ºä¿ ---
            tip_placeholder = st.empty()
            
            # --- ä¿®æ­£ç‚¹2: æ¤œç´¢é–‹å§‹æ™‚ã«æœ€åˆã®ãƒˆãƒªãƒ“ã‚¢ã‚’å³æ™‚è¡¨ç¤º ---
            display_new_tip(tip_placeholder)
            
            total_targets = len(targets)
            processed_count = 0
            raw_results = []
            
            # --- ã‚¿ã‚¤ãƒãƒ¼ã¨æœªæ¥ã®ã‚¿ã‚¹ã‚¯ç®¡ç†ã®åˆæœŸè¨­å®š ---
            # ä¿®æ­£ç‚¹1: æ›´æ–°é–“éš”ã‚’30ç§’ã«å¤‰æ›´
            tip_update_interval = 30.0 
            last_tip_time = time.time()
            
            with ThreadPoolExecutor(max_workers=MAX_WORKERS) as executor:
                future_to_ip = {executor.submit(get_ip_details_from_api, ip): ip for ip in targets}
                remaining_futures = set(future_to_ip.keys())

                while remaining_futures:
                    # 0.1ç§’ã”ã¨ã«ãƒãƒ¼ãƒªãƒ³ã‚°ã—ã€å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯ã‚’ãƒã‚§ãƒƒã‚¯
                    done, not_done = wait(
                        remaining_futures,
                        timeout=0.1,  # çŸ­ã„ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§ã‚¿ã‚¤ãƒãƒ¼ãƒã‚§ãƒƒã‚¯ã‚’å¯èƒ½ã«ã™ã‚‹
                        return_when=FIRST_COMPLETED
                    )
                    
                    # 1. å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯ã‚’å‡¦ç†
                    for future in done:
                        result = future.result()
                        raw_results.append(result)
                        processed_count += 1
                        remaining_futures.remove(future)

                        # é€²æ—ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°
                        percent_complete = int((processed_count / total_targets) * 100)
                        progress_placeholder.progress(percent_complete)
                        status_placeholder.markdown(f"**ğŸ” å‡¦ç†ä¸­:** **{processed_count}** / **{total_targets}** ä»¶å®Œäº† ({percent_complete}%)")

                    # 2. 30ç§’ã®ã‚¿ã‚¤ãƒãƒ¼ãƒã‚§ãƒƒã‚¯ã¨ãƒˆãƒªãƒ“ã‚¢ã®æ›´æ–°
                    if time.time() - last_tip_time >= tip_update_interval and processed_count < total_targets:
                        display_new_tip(tip_placeholder)
                        last_tip_time = time.time() # ã‚¿ã‚¤ãƒãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
                        
            # 6. å®Œäº†å¾Œã®å‡¦ç†
            status_placeholder.empty()
            progress_placeholder.empty()
            tip_placeholder.empty() # è±†çŸ¥è­˜ã‚’æ¶ˆå»
            
            # å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ˜ç¢ºã«è¡¨ç¤º
            st.success("ğŸ‰ æ¤œç´¢ãŒå®Œäº†ã—ã¾ã—ãŸï¼")
            st.subheader("æ¤œç´¢çµæœä¸€è¦§")
            
            # --- é›†ç´„ãƒ­ã‚¸ãƒƒã‚¯ã®é©ç”¨ ---
            if display_mode == "é›†ç´„ãƒ¢ãƒ¼ãƒ‰ (ISP/å›½åˆ¥ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–)":
                st.info("ğŸ’¡ **é›†ç´„ãƒ¢ãƒ¼ãƒ‰**ï¼šåŒã˜ISPã¨Countryã‚’æŒã¤IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã¾ã¨ã‚ã¦è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚")
                results_to_display = group_results_by_isp(raw_results)
            else:
                st.info("ğŸ’¡ **æ¨™æº–ãƒ¢ãƒ¼ãƒ‰**ï¼šå…¥åŠ›ã•ã‚ŒãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹å…¨ã¦ã‚’å€‹åˆ¥ã«è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚")
                results_to_display = raw_results
            
            # çµæœã®ãƒ†ãƒ¼ãƒ–ãƒ«æç”»
            display_results(results_to_display)
            results = raw_results # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”¨ã«å…ƒã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ
            
        # 7. çµæœã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ (ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã®ã¿è¡¨ç¤º)
        if len(results) > 0:
            df = pd.DataFrame(results)
            csv = df.to_csv(index=False).encode('utf-8')
            
            st.download_button(
                label="â¬‡ï¸ çµæœã‚’ CSV ãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
                data=csv,
                file_name='ip_rir_links_results_final.csv',
                mime='text/csv',
            )

if __name__ == "__main__":

    main()


